# Пользовательская система

Gramps Web не предназначен для публичного доступа в интернете, а только для аутентифицированных пользователей. Учетные записи пользователей могут быть созданы владельцем сайта через командную строку или веб-интерфейс, или путем саморегистрации с последующим одобрением владельцем сайта.

## Роли пользователей

В настоящее время определены следующие роли пользователей.

Роль | Идентификатор роли | Разрешения
-----|------------------|------------
Гость | 0 | Просмотр неприоритетных объектов
Участник | 1 | Гость + просмотр приоритетных объектов
Контрибьютор* | 2 | Участник + добавление объектов
Редактор | 3 | Контрибьютор + редактирование и удаление объектов
Владелец | 4 | Редактор + управление пользователями
Администратор | 5 | Владелец + редактирование других деревьев в многодеревной настройке

\* Обратите внимание, что роль "Контрибьютор" в настоящее время поддерживается только частично; например, семейные объекты не могут быть добавлены, так как они подразумевают изменение основных объектов Gramps, относящихся к членам семьи. Рекомендуется использовать другие роли, когда это возможно.

## Настройка доступа к AI чату

Если вы [настроили AI чат](chat.md), вы увидите здесь опцию для выбора групп пользователей, которым разрешено использовать функцию чата.

## Управление пользователями

Существует два способа управления пользователями:

- С правами владельца через веб-интерфейс
- В командной строке на сервере

Учетная запись владельца, необходимая для первого доступа к веб-приложению, может быть добавлена в мастере настройки, который автоматически запускается при доступе к Gramps Web с пустой базой данных пользователей.

### Управление пользователями в командной строке

При использовании [Docker Compose](deployment.md) основной командой является

```bash
docker compose run grampsweb python3 -m gramps_webapi user COMMAND [ARGS]
```

`COMMAND` может быть `add` или `delete`. Используйте `--help` для `[ARGS]`, чтобы показать синтаксис и возможные параметры конфигурации.

### Одобрение саморегистрированных пользователей

Когда пользователь саморегистрируется, ему не предоставляется немедленный доступ. На электронную почту владельца дерева отправляется сообщение о новой регистрации пользователя, а пользователю отправляется запрос по электронной почте для подтверждения его адреса электронной почты. Успешное подтверждение адреса электронной почты изменяет его роль с `unconfirmed` на `disabled`. Пока учетная запись пользователя находится в одной из этих двух ролей, пользователь не может войти в систему. Владелец дерева должен рассмотреть запрос пользователя и назначить ему соответствующую роль, прежде чем ему будет разрешено войти в систему.
