# ユーザーシステム

Gramps Webは、インターネット上での公開アクセスを目的としていません。認証されたユーザーのみがアクセスできます。ユーザーアカウントは、サイト所有者がコマンドラインまたはウェブインターフェースを介して作成するか、自己登録とその後のサイト所有者による承認を通じて作成できます。

## ユーザーロール

現在定義されているユーザーロールは以下の通りです。

Role | Role ID | Permissions
-----|---------|------------
ゲスト | 0 | 非プライベートオブジェクトの表示
メンバー | 1 | ゲスト + プライベートオブジェクトの表示
寄稿者* | 2 | メンバー + オブジェクトの追加
編集者 | 3 | 寄稿者 + オブジェクトの編集と削除
所有者 | 4 | 編集者 + ユーザーの管理
管理者 | 5 | 所有者 + マルチツリー設定で他のツリーの編集

\* 「寄稿者」ロールは現在部分的にのみサポートされています。例えば、家族オブジェクトは、家族メンバーの基盤となるGramps人物オブジェクトの変更を伴うため、追加できません。可能な限り他のロールを使用することをお勧めします。

## AIチャットを使用できるユーザーの設定

[AIチャットを設定した](chat.md)場合、ここでチャット機能を使用できるユーザーグループを選択するオプションが表示されます。

## ユーザーの管理

ユーザーを管理する方法は2つあります：

- ウェブインターフェースを使用して所有者権限で管理
- サーバーのコマンドラインで管理

ウェブアプリに最初にアクセスするために必要な所有者アカウントは、空のユーザーデータベースでGramps Webにアクセスしたときに自動的に起動されるオンボーディングウィザードで追加できます。

### コマンドラインでのユーザー管理

[Docker Compose](deployment.md)を使用する場合、基本コマンドは次の通りです。

```bash
docker compose run grampsweb python3 -m gramps_webapi user COMMAND [ARGS]
```

`COMMAND`は`add`または`delete`です。`--help`を使用して`[ARGS]`の構文と可能な設定オプションを表示します。

### 自己登録ユーザーの承認

ユーザーが自己登録すると、即座にアクセスが許可されるわけではありません。新しいユーザー登録についてツリー所有者にメールが送信され、ユーザーにはメールアドレスを確認するためのメールリクエストが送信されます。メールアドレスを正常に確認すると、ユーザーのロールは`unconfirmed`から`disabled`に変更されます。ユーザーアカウントがこれらの2つのロールのいずれかにある間、ユーザーはログインできません。ツリー所有者はユーザーのリクエストを確認し、ログインを許可する前に適切なロールを割り当てる必要があります。
