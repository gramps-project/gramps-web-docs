# Gramps 5.2 升级指南

**Gramps 5.2** 于 2024 年 2 月 23 日发布。由于它使用了与 Gramps 5.1 不同的新家谱数据库架构，因此在将 Gramps Web 升级为与 Gramps 5.2 一起使用时，需要额外的步骤。此页面描述了必要的步骤。

## 步骤概述

这是升级所需步骤的概述。  
它还显示了哪些步骤由 Gramps Web 服务器的管理员、家谱的所有者执行，以及是否仅对 [同步插件](../administration/sync.md) 的用户需要。

| 服务器管理员 | 树的所有者  | 操作 |
|----|----|----|
| &nbsp; | ✓ | 备份您的家谱 |
| &nbsp; | ✓ <sup>1</sup> |  [将 Gramps Web 与 Gramps Desktop 同步](../administration/sync.md) |
| ✓ |  | [更新 Gramps Web](update.md) |
| &nbsp; | ✓ | 更新树的数据库架构 |
| &nbsp; | ✓ <sup>1</sup> | 更新 Gramps Desktop |
| &nbsp; | ✓ <sup>1</sup> | 安装更新的同步插件 |
| &nbsp; | ✓ | 备份您的家谱 |
| &nbsp; | ✓ <sup>1</sup> | [将 Gramps Web 与 Gramps Desktop 同步](../administration/sync.md) |

<sup>1</sup> 仅在您将 Gramps Web 与 Gramps Desktop 同步时需要。

## 发布状态概述

下表概述了与 Gramps 5.2 一起使用的 Gramps Web 所需组件的发布情况。

| 组件 | 发布日期 |
|---|---|
| Gramps 5.2.0 | 2024-02-23 ✓ |
| Gramps Web Sync Addon 1.0.4 for Gramps 5.2 | 2024-02-23 ✓ |
| Gramps Web API 2.0.0 | 2024-02-28 ✓ |
| Gramps Web 23.3.0 | 2024-02-28 ✓ |

## 详细步骤

本节提供有关上述某些单独步骤的更多详细信息。

### 备份您的家谱

在 Gramps Web 中，转到“导出”页面，选择“Gramps XML（家谱）”（默认选项）。点击“生成”，并等待 .gramps 文件的下载开始。

您还可以按照 [通常的方式](https://www.gramps-project.org/wiki/index.php/How_to_make_a_backup) 在 Gramps Desktop 中创建备份。

### 更新树的数据库架构

当您在升级后第一次访问 Gramps Web 时，您将看到一条消息：

> 您尝试加载的家谱处于此版本的 Gramps Web 不支持的架构版本中。因此，您无法在不升级其架构的情况下加载此家谱。此操作无法撤消。

您现在可以点击“升级家谱”按钮。它将显示进度条，完成时间不应超过一分钟。请不要担心，如果您不小心关闭了浏览器窗口，转换将在后台继续进行。

!!! warning
    如果您使用的是 *没有* 后台任务队列的非标准设置，数据库升级可能会失败，您的家谱可能会损坏。您可以在更新 Gramps Web 之前，通过转到设置中的“系统信息”部分，确保它具有“任务队列：true”来检查您是否正在使用后台任务队列。

### 更新 Gramps Desktop

按照您操作系统的 Gramps Desktop 安装说明进行操作。

### 安装更新的同步插件

您可以使用 Gramps 5.2 中包含的 [新插件管理器](https://gramps-project.org/wiki/index.php/Addon:Plugin_Manager) - 只需搜索 Gramps Web Sync，点击安装，然后重启 Gramps。
